<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>广播消息</title>
  <meta name="generator" content="Adobe RoboHelp 2019" />
  <link rel="stylesheet" href="../../assets/css/default.css" type="text/css" />
  <meta name="rh-authors" content="Mark Alexander" />
  <meta name="topic-comment" content="详细说明dope sheet" />
  <meta name="rh-index-keywords" content="序列-广播消息" />
  <meta name="search-keywords" content="播送,讯息,广播消息" />
</head>
<body><!--<div class="body-scroll" style="top: 150px;">--><h1>广播消息</h1><p><a href="../Sequences.htm">序列</a>和子<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sprites/Sprites.htm">画面</a>都可以在其长度的任何点生成所谓的<strong>广播消息。</strong>这些消息是简单的字符串，它们被添加到沿动画时间轴的特定帧中，并且当到达时间轴中的该点时，该字符串将被广播到所有监听它的实例中。任何具有<a href="../Object_Properties/Other_Events.htm">广播消息事件的</a>实例（位于“<strong>其他</strong>”事件类别中）将在时间轴上到达时收到消息字符串，这时您将需要一些代码来对其进行解析并做出相应的反应。还要注意，序列也可以侦听广播消息，但这要求您首先使用代码设置侦听器方法（有关更多信息， <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">请参见序列事件和时刻</a><span class="notranslate">GML</span>部分）。</p><p class="note"><strong>注意：</strong>将实例的image_index直接设置为一个帧<em>不会</em>触发对象的sprite的该帧上可能存在的任何广播消息。</p><p>要将广播消息添加到序列或精灵时间轴，只需单击<img alt="Broadcast Message Button Icon" class="icon" src="../../assets/Images/Icons/Icon_Broadcast.png" />按钮。这将打开一个对话框，您可以在其中添加要广播的消息：</p><p class="dropspot"><img alt="Add A broadcast message to a sequence" class="center" src="../../assets/Images/Asset_Editors/Editor_Sequences_Broadcast.gif" style="cursor: nesw-resize;" /></p><p>添加后，该消息将显示在“ <span class="notranslate">Dope Sheet</span> （或Sprite框架视图）中。要对其进行编辑，必须单击鼠标右键<img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21" />在消息图标上可以打开与框架重叠的所有消息的列表（一个框架上只能有一条消息，但是在连续的框架上放置多条消息会导致它们在视觉上重叠，从而使您难以选择想要的一条消息并且您也可以<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">在同一帧上显示一条消息和一会儿</a>），然后从该列表中选择一个将打开消息对话框，您可以在其中编辑或删除它。</p><p>触发广播消息事件时，将<a href="../../GameMaker_Language/GML_Reference/Data_Structures/DS_Maps/DS_Maps.htm">创建一个特殊的DS Map</a> ，并将其存储在内置变量中 <span class="inline">event_data</span>。此变量ID是内置的<em>全局</em>范围变量，但仅在触发它的事件（在本例中为“广播消息”事件）中包含DS映射数据，并且在所有其他时间返回-1。该事件将具有的键如下：</p><ul class="colour"><li> ”<span class="inline">event_type</span> “：对于广播消息，这将是字符串”<span class="inline">sequence event</span> “表示从序列发送的消息，而“<span class="inline">sprite event</span> ”以获取从Sprite发送的消息。</li><li> ”<span class="inline">message</span> “：此密钥包含已收到的消息字符串。</li><li> ”<span class="inline">element_id</span> “：此键返回房间编辑器中某个图层上的元素的ID（序列/子画面/实例）。然后，您可以使用此ID值来查找使用该函数生成消息的元素的类型<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_element_type.htm"><span class="inline">layer_get_element_type()</span></a>并根据需要使用其他相关功能进行定位，或执行类似播放声音的操作。</li></ul><p>请注意，实例的广播消息事件在每次发送广播消息时都会收到多个字符串。您不需要对所有它们都采取行动，并且可以让不同的实例侦听不同的广播字符串。但是，您可能有一个实例正在侦听可能同时收到的消息。发生这种情况时，事件将被多次触发-<em>每个消息字符串一次</em>。</p><p>下面是如何检查此事件的简要示例： </p><p class="code">if event_data[? &quot;event_type&quot;] == &quot;sequence event&quot;<br/> {
    <br/> switch (event_data[? &quot;message&quot;])<br/>     {<br/>     case &quot;hit&quot;:<br/>         audio_play_sound(snd_hit, 0, false);<br/>         break;<br/>     case &quot;destroy&quot;:<br/>         sequence_destroy(event_data[? &quot;element_id&quot;]);<br/>            break;<br/>     }<br/> }
  </p><p></p><p></p><p></p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">背面：<a href="../Sequences.htm">序列</a></div><div style="float:right">下一页：<a href="The_Sequence_Canvas.htm">序列画布</a></div></div></div><h5><span data-keyref="Copyright Notice">©版权所有<span class="notranslate">YoYo Games Ltd.</span> 2021保留所有权利</span></h5>
  </div>
  <!-- KEYWORDS
Sequences - Broadcast Messages
Broadcast Messages
-->
  <!-- TAGS
sequences_broadcast_messages
-->
</body>
</html>